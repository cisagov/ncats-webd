{% extends "base_template.html" %}
{% block title %}Metrics Results{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block body %}
    <div class="row">
        <div class="large-12 columns">
			<h1>Metrics Results</h1>
        </div>
    </div>
	<div class="row">
		<div class="large-12 columns">
    For the Dates {{START}} to {{END}}:

	<p>
	{% if VULN_TICKET %}
	  {{ VULN_TICKET.severity_level }} Vulnerability Tickets<br>
	  =====================
      <br>{{ VULN_TICKET.severity_level }} Vulnerability tickets opened before {{START}} and still open now: {{ VULN_TICKET.opened_before_and_still_open }}
      <br>{{ VULN_TICKET.severity_level }} Vulnerability tickets opened before {{START}} and closed by {{END}}: {{ VULN_TICKET.opened_before_and_closed_during }}
      <br>{{ VULN_TICKET.severity_level }} Vulnerability tickets opened between {{START}} and {{END}}, and still open now: {{ VULN_TICKET.opened_during_and_still_open }}
      <br>{{ VULN_TICKET.severity_level }} Vulnerability tickets opened after {{START}} and closed by {{END}}: {{ VULN_TICKET.opened_during_and_closed_during }}
      <br>{{ VULN_TICKET.severity_level }} Vulnerability tickets opened between {{START}} and {{END}}, and closed after {{END}}: {{ VULN_TICKET.opened_during_and_closed_after }}
      <br>False positives tickets opened before {{START}}: {{VULN_TICKET.fp_before}}
      <br>False positives tickets opened between {{START}} and {{END}}: {{VULN_TICKET.fp_during}}
      <br>False positives tickets opened after {{END}}: {{VULN_TICKET.fp_after}}
	  <br><br>{{ VULN_TICKET.description }}
	{% endif %}
    </p>

	<p>
	{% if TOP_VULNS %}
	  Top 10 {{ TOP_VULNS.level }} Ticketed Vulnerabilities<br>
	  {{ TOP_VULNS.level }} Vulnerability Tickets Opened: {{ TOP_VULNS.total }}<br>
	  =====================
	  {% for i in TOP_VULNS.data %}
	      <br>{{ i.vuln }}: {{ i.count }} ({{ i.pct }}%)
	  {% endfor %}
	  <br><br>{{ TOP_VULNS.description }}
	{% endif %}
    </p>

	<p>
	{% if TOP_OS %}
	  Top 10 Operating System Fingerprints<br>
	  Total Fingerprinted Hosts: {{ TOP_OS.total }}<br>
	  =====================
	  {% for i in TOP_OS.data %}
	      <br>{{ i.OS }}: {{ i.count }} ({{ i.pct }}%)
	  {% endfor %}
	  <br><br>{{ TOP_OS.description }}
	{% endif %}
    </p>

	<p>
	{% if TOPVULNSERV %}
	  Top 10 Vulnerable Services<br>
	  Total Vulnerable Services: {{ TOPVULNSERV.total }}<br>
	  =====================
	  {% for i in TOPVULNSERV.data %}
	      <br>{{ i.service }}: {{ i.count }} ({{ i.pct }}%)
	  {% endfor %}
	  <br><br>{{ TOPVULNSERV.description }}
	{% endif %}
    </p>

	<p>
	{% if TOPSERV %}
	  Top 10 Services<br>
	  Total Services: {{ TOPSERV.total }}<br>
	  =====================
	  {% for i in TOPSERV.data %}
	      <br>{{ i.service }}: {{ i.count }} ({{ i.pct }}%)
	  {% endfor %}
	  <br><br>{{ TOPSERV.description }}
	{% endif %}
    </p>

	<p>
	{% if NUMORGS %}
      Total stakeholder organizations scanned: {{ NUMORGS.total_orgs }}<br>
	  =====================
      <br>* FEDERAL stakeholder organizations: {{ NUMORGS.fed_orgs }} ({{ NUMORGS.fed_orgs_pct }}%)
      <br>* SLTT stakeholder organizations: {{ NUMORGS.sltt_orgs }} ({{ NUMORGS.sltt_orgs_pct }}%)
	  <br>* PRIVATE stakeholder organizations: {{ NUMORGS.private_orgs }} ({{ NUMORGS.private_orgs_pct }}%)
	  <br><br>{{ NUMORGS.description }}
	{% endif %}
    </p>

	<p>
	{% if NUMADDRHOSTS %}
      Total addresses scanned: {{ NUMADDRHOSTS.total_addr }}<br>
	  =====================
      <br>* Total FEDERAL addresses: {{ NUMADDRHOSTS.fed_addr }} ({{ NUMADDRHOSTS.fed_addr_pct }}%)
      <br>* Total SLTT addresses: {{ NUMADDRHOSTS.sltt_addr }} ({{ NUMADDRHOSTS.sltt_addr_pct }}%)
	  <br>* Total PRIVATE addresses: {{ NUMADDRHOSTS.private_addr }} ({{ NUMADDRHOSTS.private_addr_pct }}%)
	  <br><br>{{ NUMADDRHOSTS.description1 }}
	  <br><br>
      Total hosts scanned: {{ NUMADDRHOSTS.total_hosts }}<br>
	  =====================
      <br>* Total FEDERAL hosts: {{ NUMADDRHOSTS.fed_hosts_scanned }} ({{ NUMADDRHOSTS.fed_hosts_scanned_pct }}%)
      <br>* Total SLTT hosts: {{ NUMADDRHOSTS.sltt_hosts_scanned }} ({{ NUMADDRHOSTS.sltt_hosts_scanned_pct }}%)
	  <br>* Total PRIVATE hosts: {{ NUMADDRHOSTS.private_hosts_scanned }} ({{ NUMADDRHOSTS.private_hosts_scanned_pct }}%)
	  <br><br>{{ NUMADDRHOSTS.description2 }}
	  <br><br>
      Total vulnerable hosts detected during scans: {{ NUMADDRHOSTS.total_vuln_hosts }}<br>
	  =====================
      <br>* Total FEDERAL vulnerable hosts: {{ NUMADDRHOSTS.fed_vuln_hosts }} ({{ NUMADDRHOSTS.fed_vuln_hosts_pct }}%)
      <br>* Total SLTT vulnerable hosts: {{ NUMADDRHOSTS.sltt_vuln_hosts }} ({{ NUMADDRHOSTS.sltt_vuln_hosts_pct }}%)
	  <br>* Total PRIVATE vulnerable hosts: {{ NUMADDRHOSTS.private_vuln_hosts }} ({{ NUMADDRHOSTS.private_vuln_hosts_pct }}%)
	  <br><br>{{ NUMADDRHOSTS.description4 }}
	{% endif %}
    </p>

	<p>
	{% if NUMREPORTS %}
      Total CyHy reports generated: {{ NUMREPORTS.total_reports }}<br>
	  =====================
      <br>* FEDERAL CyHy reports: {{ NUMREPORTS.fed_reports }} ({{ NUMREPORTS.fed_reports_pct }}%)
	  <br>* SLTT CyHy reports: {{ NUMREPORTS.sltt_reports }} ({{ NUMREPORTS.sltt_reports_pct }}%)
	  <br>* PRIVATE CyHy reports: {{ NUMREPORTS.private_reports }} ({{ NUMREPORTS.private_reports_pct }}%)
	  <br><br>{{ NUMREPORTS.description }}
	{% endif %}
    </p>

	<p>
	{% if AVGCVSS %}
      Average CVSS score for hosts with vulnerabilities: {{ AVGCVSS.overall_cvss }}<br>
	  =====================
      <br>* FEDERAL average CVSS score: {{ AVGCVSS.fed_cvss }}
	  <br>* SLTT average CVSS score: {{ AVGCVSS.sltt_cvss }}
	  <br>* PRIVATE average CVSS score: {{ AVGCVSS.private_cvss }}
	  <br><br>{{ AVGCVSS.description }}
	{% endif %}
    </p>

	<p>
	{% if UVULNS %}
	  {% for i in UVULNS.data %}
	      <br>{{ i.type }} unique vulnerabilities discovered: {{ i.total }}<br>
		  =====================
	      <br>* Critical: {{ i.crit }} ({{ i.crit_pct }}%)
		  <br>* High: {{ i.high }} ({{ i.high_pct }}%)
		  <br>* Medium: {{ i.med }} ({{ i.med_pct }}%)
		  <br>* Low: {{ i.low }} ({{ i.low_pct }}%)
	  {% endfor %}
	  <br><br>{{ UVULNS.description }}
	{% endif %}
    </p>

	<p>
	{% if NVULNDET %}
	  {% for i in NVULNDET.data %}
	      <br>{{ i.type }} vulnerabilities tickets opened: {{ i.total }}<br>
		  =====================
	      <br>* Critical: {{ i.crit }} ({{ i.crit_pct }}%)
		  <br>* High: {{ i.high }} ({{ i.high_pct }}%)
		  <br>* Medium: {{ i.med }} ({{ i.med_pct }}%)
		  <br>* Low: {{ i.low }} ({{ i.low_pct }}%)
	  {% endfor %}
	  <br><br>{{ NVULNDET.description }}
	{% endif %}
    </p>
		</div>
	</div>
{% endblock %}
